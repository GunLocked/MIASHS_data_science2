---
title: "DS2"
output: html_document
date: "2025-11-12"
---

2.1) Modèle linéaire (cas simple)

```{r}
generate_lm <- function(n, p, p0, sigma2) {

  # 1. Vecteur des coefficients vrais β
  beta <- numeric(p)
  support <- sample(1:p, p0)  # indices des variables actives
  beta[support] <- runif(p0, 1, 2) * sample(c(-1, 1), p0, replace = TRUE)

  # 2. Génération des prédicteurs indépendants : N(0,1)
  X <- matrix(rnorm(n * p), nrow = n, ncol = p)

  # 3. Génération du bruit gaussien
  epsilon <- rnorm(n, mean = 0, sd = sqrt(sigma2))

  # 4. Réponse
  y <- X %*% beta + epsilon

  # 5. Retourne la liste complète
  return(list(y = as.numeric(y), X = X, beta = beta))
}

# Générons un jeu de données simple
set.seed(42)
data <- generate_lm(n = 100, p = 10, p0 = 3, sigma2 = 1)

# Ajustement du modèle linéaire
fit <- lm(data$y ~ data$X - 1)
summary(fit)

# Coefficients estimés
beta_hat <- coef(fit)
beta_true <- data$beta

# Comparaison numérique
cbind(beta_true, beta_hat)

# Visualisation
plot(beta_true, beta_hat,
     main = expression(paste("Comparaison entre ", hat(beta), " et ", beta, " (cas simple)")),
     xlab = "β vrais", ylab = "β estimés",
     pch = 19, col = c("blue", "black"), xlim = range(beta_true)*1.2, ylim = range(beta_hat)*1.2)
abline(a = 0, b = 1, col = "red", lwd = 2)  # ligne parfaite β_hat = β
grid()

# Barplot comparatif
barplot(rbind(data$beta, beta_hat),
        beside = TRUE, col = c("skyblue", "orange"),
        names.arg = paste0("X", 1:length(beta_hat)),
        main = expression(paste("Comparaison entre ", hat(beta), " et ", beta, " (cas simple)")),
        ylab = "Valeur des coefficients")
legend("topright", legend = c("β vrai", "β estimé"),
       fill = c("skyblue", "orange"), bty = "n")


# Extraction des p-values
pvals <- summary(fit)$coefficients[, "Pr(>|t|)"]
support <- (data$beta != 0) * 1  # 1 si beta vrai ≠ 0

# Nuage de points p-value selon le beta vrai
plot(data$beta, pvals,
     main = "Significativité des coefficients (test de Student)",
     xlab = "β vrai", ylab = "p-value",
     pch = 19, col = ifelse(support == 1, "blue", "grey"))
abline(h = 0.05, col = "red", lty = 2)
legend("topright", legend = c("β vrai ≠ 0", "β vrai = 0"),
       col = c("blue", "grey"), pch = 19, bty = "n")

```

